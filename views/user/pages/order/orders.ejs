<div class="flex pb-20">
  <%- include("../../partials/organisms/ProfileSidebar.ejs") %>
  
  <div class="max-w-6xl w-full mx-auto p-4 space-y-4">
    <div class="flex justify-between">
      <!-- Search Bar -->
      <div  class="relative mb-10">
      <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
      <input
        id="searchField"
        type="text"
        placeholder="Search orders..."
        class="pl-10 pr-4 py-2 w-full md:w-64 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
      />
      <a  href="/account/orders?search=" class="px-4 pr-4 py-2 bg-blue-50 border border-blue-400 hover:bg-blue-100 text-blue-600 font-semibold rounded-[8px]">clear</a>
      </div>

     <!-- Status Filter Dropdown -->
      <div x-data="{ open: false, selectedStatus: 'All', statuses: ['All', 'Pending', 'Confirmed', 'Shipped', 'Delivered', 'Cancelled', 'Returned'],
          init() {
            const params = new URLSearchParams(window.location.search);
            const status = params.get('category');
            if (status && this.statuses.includes(status)) {
                this.selectedStatus = status;
            }
          }
       }"
      class="relative">
        <!-- Button -->
        <button
            @click="open = !open"
            class="w-full md:w-48 flex items-center justify-between px-4 py-2 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
        >
            <span class="text-gray-700" x-text="selectedStatus"></span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
        </button>

        <!-- Dropdown Menu -->
        <div x-show="open" @click.away="open = false" class="absolute z-10 w-full mt-2 bg-white border border-gray-300 rounded-lg shadow-lg">
            <template x-for="status in statuses" :key="status">
                <button 
                    class="status-item w-full px-4 py-2 text-left hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg"
                    @click="selectedStatus = status; open = false"
                    :value="status"
                    x-text="status">
                </button>
            </template>
        </div>
      </div>
    </div>
    <!-- In Progress Order -->
     <% orders.forEach((item) => { %>
      <a href="/account/orders/<%= item._id  %>">
        <div class="rounded-2xl p-4 shadow-sm">
          <div class="flex justify-between items-start mb-4">
            <div x-data="{ status: '<%= item.orderStatus %>' }" class="flex items-center space-x-2">
              <span
                :class="{
                  'bg-yellow-100 text-yellow-800': status === 'Pending',
                  'text-indigo-600 bg-indigo-50' : status === 'Confirmed',
                  'bg-purple-100 text-purple-500' : status === 'Shipped',
                  'bg-green-50 text-green-600': status === 'Delivered',
                  'bg-red-50 text-red-600 ': status === 'Cancelled'
                }" 
                class="px-3 py-1 rounded-full text-sm font-medium"
                ><%= item.orderStatus %></span
              >
              <span class="text-gray-600"><%= new Date(item.orderDate).toLocaleDateString("en-GB") %></span>
            </div>
          </div>
    
          <div class="flex items-center justify-between">
            <div class="flex space-x-4">
              <div class="relative">
                <img
                  src="<%= item.orderThumbnail %>"
                  alt="order thumbnail"
                  class="rounded-lg w-20 h-20 object-cover"
                />
                <!-- <span
                  class="absolute bottom-0 right-0 bg-black bg-opacity-60 text-white text-xs px-1 rounded"
                  >+1</span
                > -->
              </div>
              <div>
                <p class="text-gray-800 font-medium">Order ID: <%= item.orderId %></p>
                <p class="text-gray-800">
                  <%= item.productName %>
                </p>
                <!-- <span class="text-blue-600">1 more item</span> -->
                <p class="text-gray-800 font-medium mt-1">â‚¹<%= item.totalAmount %></p>
              </div>
            </div>
            <button class="text-gray-400 hover:text-gray-600">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                />
              </svg>
            </button>
          </div>
        </div>
      </a>
     <% }) %>
     <div class="flex justify-center space-x-2 mt-4">
      <% if (page> 1) { %>
          <a href="/account/orders?page=<%= page - 1 %>"
              class="px-3 py-2 bg-gray-200 rounded-lg hover:bg-gray-300">Previous</a>
          <% } %>

              <% for (let i=1; i <=totalPages; i++) { %>
                  <a href="/account/orders?page=<%= i %>"
                      class="px-3 py-2 rounded-lg <%= page === i ? 'bg-blue-500 text-white' : 'bg-gray-200 hover:bg-gray-300' %>">
                      <%= i %>
                  </a>
                  <% } %>

                      <% if (page < totalPages) { %>
                          <a href="/account/orders?page=<%= page + 1 %>"
                              class="px-3 py-2 bg-gray-200 rounded-lg hover:bg-gray-300">Next</a>
                          <% } %>
        </div>
    <!-- Delivered Order -->
    <!-- <div class="bg-white rounded-2xl p-4 shadow-sm">
      <div class="flex justify-between items-start mb-4">
        <div class="flex items-center space-x-2">
          <span
            class="bg-green-50 text-green-600 px-3 py-1 rounded-full text-sm font-medium"
            >Delivered</span
          >
          <span class="text-gray-600">5 Jan 2025</span>
        </div>
      </div>

      <div class="flex items-center justify-between">
        <div class="flex space-x-4">
          <div class="relative">
            <img
              src="https://placehold.co/80x80"
              alt="Hybrid Mattress"
              class="rounded-lg w-20 h-20 object-cover"
            />
          </div>
          <div>
            <p class="text-gray-800">Hybrid Mattress</p>
            <p class="text-gray-600 text-sm mt-1">Delivered 13 January</p>
          </div>
        </div>
        <button class="text-gray-400 hover:text-gray-600">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 5l7 7-7 7"
            />
          </svg>
        </button>
      </div>
    </div> -->

    <!-- Cancelled Order -->
    <!-- <div class="bg-white rounded-2xl p-4 shadow-sm">
      <div class="flex justify-between items-start mb-4">
        <div class="flex items-center space-x-2">
          <span
            class="bg-red-50 text-red-600 px-3 py-1 rounded-full text-sm font-medium"
            >Cancelled</span
          >
          <span class="text-gray-600">5 Jan 2025</span>
        </div>
      </div>

      <div class="flex items-center justify-between">
        <div class="flex space-x-4">
          <div class="relative">
            <img
              src="https://placehold.co/80x80"
              alt="Hybrid Mattress"
              class="rounded-lg w-20 h-20 object-cover"
            />
            <span
              class="absolute bottom-0 right-0 bg-black bg-opacity-60 text-white text-xs px-1 rounded"
              >+1</span
            >
          </div>
          <div>
            <p class="text-gray-800 font-medium">Order ID: 354654654526</p>
            <p class="text-gray-800">
              Hybrid Mattress & <span class="text-blue-600">1 more item</span>
            </p>
          </div>
        </div>
        <button class="text-gray-400 hover:text-gray-600">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 5l7 7-7 7"
            />
          </svg>
        </button>
      </div>
    </div> -->
  </div>
</div>
<script type="module" src="/javascript/ajax/pages/userOrders.js"></script>
